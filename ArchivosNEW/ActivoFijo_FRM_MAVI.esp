[ActivoFijo.frm/(Carpeta Abrir)]FiltroAutoCampo=ActivoFijo.MonedaFiltroAutoValidar=ActivoFijo.Moneda[ActivoFijo.frm/Forma]PosicionInicialIzquierda=286PosicionInicialArriba=105PosicionInicialAltura=534PosicionInicialAncho=708PosicionInicialAlturaCliente=555[ActivoFijo.frm/Detalle]ListaEnCaptura=ActivoFijoD.Articulo<BR>ActivoFijoD.Serie<BR>ActivoFijoD.Observaciones<BR>ActivoFijoD.Horas<BR>ActivoFijoD.Importe<BR>ActivoFijoD.Impuestos<BR>ImporteTotal<BR>ActivoFijoD.NuevoValor<BR>ActivoFijoD.MesesDepreciados<BR>ActivoFijoD.Depreciacion<BR>ActivoFijoD.DepreciacionPorcentaje<BR>ActivoFijoD.Inflacion<BR>ActivoFijoD.ActualizacionCapital<BR>ActivoFijoD.ActualizacionDepreciacion<BR>ActivoFijoD.UnidadKm<BR>ActivoFijoD.UltimoKmServicio<BR>ActivoFijoD.UltimoTipoServicio[ActivoFijo.frm/Detalle.ActivoFijoD.UltimoKmServicio]Carpeta=DetalleClave=ActivoFijoD.UltimoKmServicioEditar=NLineaNueva=SValidaNombre=S3D=SColorFondo=BlancoColorFuente=Negro[ActivoFijo.frm/Detalle.ActivoFijoD.UltimoTipoServicio]Carpeta=DetalleClave=ActivoFijoD.UltimoTipoServicioEditar=NLineaNueva=SValidaNombre=S3D=STamano=10ColorFondo=BlancoColorFuente=Negro[ActivoFijo.frm/Detalle.ActivoFijoD.UnidadKm]Carpeta=DetalleClave=ActivoFijoD.UnidadKmEditar=SLineaNueva=SValidaNombre=S3D=SColorFondo=BlancoColorFuente=Negro[ActivoFijo.frm/Acciones.Afectar]AntesExpresiones=Asigna(Info.IDMAVI, ActivoFijo:ActivoFijo.ID)<BR>Si<BR> General.CamposExtras=<T>Campos Extras<T> y (ActivoFijo:ActivoFijo.Estatus en (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)) y SQL(<T>SELECT CEAntesAfectar FROM MovTipo WHERE Modulo=:tModulo AND Mov=:tMov AND CE=1<T>, <T>AF<T>, ActivoFijo:ActivoFijo.Mov)<BR>Entonces<BR> Si(no CamposExtrasMovimiento(<T>AF<T>, ActivoFijo:ActivoFijo.Mov, ActivoFijo:ActivoFijo.ID, Verdadero, ActivoFijo:ActivoFijo.Estatus noen (EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador)), AbortarOperacion)<BR>FIn<BR>Si (ActivoFijo:ActivoFijo.Mov en(<T>Mantenimiento<T>, <T>Mantenimiento Ligero<T>, <T>Mantenimiento Severo<T>, <T>Mannto Maquinaria<T>)) y (ActivoFijo:ActivoFijo.Estatus en(EstatusSinAfectar, EstatusPorConfirmar, EstatusBorrador))<BR> Entonces<BR> Si(SQL(<T>spValidarManntoARecibi<CONTINUA>AntesExpresiones002=<CONTINUA>rMAVI:nID,:tMov<T>, ActivoFijo:ActivoFijo.ID, ActivoFijo:ActivoFijo.Mov)=1, Si(Error(<T>Hay activos fijos en el detalle del movimiento que reciben un mantenimiento diferente al movimiento que se desea generar, consultar catalogo de activos fijos<T>,BotonAceptar)=BotonAceptar,AbortarOperacion,AbortarOperacion))<BR> Si(SQL(<T>spAFEnMantenimientoMAVI:nID,:tMov,:tConcepto<T>, ActivoFijo:ActivoFijo.ID, ActivoFijo:ActivoFijo.Mov, ActivoFijo:ActivoFijo.Concepto)=1, Si(Error(<T>Hay activos fijos en mantenimiento<T>,BotonAceptar)=BotonAceptar,AbortarOperacion,AbortarOperacion))<BR> ActualizarVista<BR> Si ActivoFijo:ActivoFijo.Mov en(<T>Mantenimiento Ligero<T>, <T>Mantenimiento Severo<T>, <T>Mannto Maquinaria<T>)<BR> Entonces<BR> Si(SQL(<T>spAntesGenerarManntoMAVI:nID,:tM<CONTINUA>AntesExpresiones003=<CONTINUA>ov,:fEmision<T>, ActivoFijo:ActivoFijo.ID, ActivoFijo:ActivoFijo.Mov, ActivoFijo:ActivoFijo.FechaEmision)=1, Si(Error(<T>No se pueden realizar mantenimientos del mismo tipo a un activo fijo el mismo dma<T>,BotonAceptar)=BotonAceptar,AbortarOperacion,AbortarOperacion))<BR> Si(SQL(<T>spAFValidarTipoManntoMAVI:nID,:tMov<T>, ActivoFijo:ActivoFijo.ID, ActivoFijo:ActivoFijo.Mov)=1, Si(Error(<T>Hay tipos de mantenimiento en el detalle que no corresponden con el movimiento<T>,BotonAceptar)=BotonAceptar,AbortarOperacion,AbortarOperacion))<BR> Si(SQL(<T>SELECT COUNT(Articulo) FROM ActivoFijoD WHERE ID =:nID AND (AumentoKmServicio = NULL OR AumentoKmServicio <=0)<T>, ActivoFijo:ActivoFijo.ID)>0,Si(Error(<T>Hay activos fijos para los que no se han definido las horas/Kms del servicio<T<CONTINUA>AntesExpresiones004=<CONTINUA>>,BotonAceptar)=BotonAceptar, AbortarOperacion, AbortarOperacion))<BR> Si(SQL(<T>spAFValidarCapturaKmUnidadMAVI:nID,:tMov<T>, ActivoFijo:ActivoFijo.ID, ActivoFijo:ActivoFijo.Mov)=1, Si(Error(<T>Hay activos fijos del detalle del movimiento a los que no se les ha capturado el kilometraje o estan fuera del rango permitido<T>,BotonAceptar)=BotonAceptar,AbortarOperacion,AbortarOperacion))<BR> Fin<BR> Fin[ActivoFijo.frm/Acciones.Cancelar]AntesExpresiones=Asigna( Afectar.Mov, ActivoFijo:ActivoFijo.Mov)<BR>Asigna( Afectar.MovID, ActivoFijo:ActivoFijo.MovID)<BR>Si (ActivoFijo:ActivoFijo.Mov en(<T>Mantenimiento Ligero<T>,<T>Mantenimiento Severo<T>,<T>Mannto Maquinaria<T>)) y (ActivoFijo:ActivoFijo.Estatus en(EstatusConcluido))<BR> Entonces<BR> Si(SQL(<T>spAntesCancelarManntoMAVI:nID,:fFEmision<T>, ActivoFijo:ActivoFijo.ID, ActivoFijo:ActivoFijo.FechaEmision)=1, Si(Error(<T>No se pueden cancelar movimientos de mantenimiento intermedios<T>,BotonAceptar)=BotonAceptar,AbortarOperacion,AbortarOperacion))<BR> Fin[ActivoFijo.frm/Acciones.CamposExtras]Antes=SDespuesGuardar=SAntesExpresiones=Asigna(Info.IDMAVI, ActivoFijo:ActivoFijo.ID)[ActivoFijo.frm/Ficha.ActivoFijo.TipoCambio]Editar=N